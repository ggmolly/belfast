// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.28.0
// source: account_roles.sql

package gen

import (
	"context"

	"github.com/jackc/pgx/v5/pgtype"
)

const countAccountsWithRoleExceptAccount = `-- name: CountAccountsWithRoleExceptAccount :one
SELECT COUNT(*)::bigint
FROM account_roles
WHERE role_id = $1
  AND ($2::text = '' OR account_id <> $2)
`

type CountAccountsWithRoleExceptAccountParams struct {
	RoleID  string
	Column2 string
}

func (q *Queries) CountAccountsWithRoleExceptAccount(ctx context.Context, arg CountAccountsWithRoleExceptAccountParams) (int64, error) {
	row := q.db.QueryRow(ctx, countAccountsWithRoleExceptAccount, arg.RoleID, arg.Column2)
	var column_1 int64
	err := row.Scan(&column_1)
	return column_1, err
}

const createAccountRoleLink = `-- name: CreateAccountRoleLink :exec
INSERT INTO account_roles (account_id, role_id, created_at)
VALUES ($1, $2, $3)
ON CONFLICT (account_id, role_id) DO NOTHING
`

type CreateAccountRoleLinkParams struct {
	AccountID string
	RoleID    string
	CreatedAt pgtype.Timestamptz
}

func (q *Queries) CreateAccountRoleLink(ctx context.Context, arg CreateAccountRoleLinkParams) error {
	_, err := q.db.Exec(ctx, createAccountRoleLink, arg.AccountID, arg.RoleID, arg.CreatedAt)
	return err
}

const deleteAccountRolesByAccountID = `-- name: DeleteAccountRolesByAccountID :exec
DELETE FROM account_roles
WHERE account_id = $1
`

func (q *Queries) DeleteAccountRolesByAccountID(ctx context.Context, accountID string) error {
	_, err := q.db.Exec(ctx, deleteAccountRolesByAccountID, accountID)
	return err
}

const listAccountRoleIDs = `-- name: ListAccountRoleIDs :many
SELECT role_id
FROM account_roles
WHERE account_id = $1
`

func (q *Queries) ListAccountRoleIDs(ctx context.Context, accountID string) ([]string, error) {
	rows, err := q.db.Query(ctx, listAccountRoleIDs, accountID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []string
	for rows.Next() {
		var role_id string
		if err := rows.Scan(&role_id); err != nil {
			return nil, err
		}
		items = append(items, role_id)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const listAccountRoleNames = `-- name: ListAccountRoleNames :many
SELECT roles.name
FROM account_roles
JOIN roles ON roles.id = account_roles.role_id
WHERE account_roles.account_id = $1
ORDER BY roles.name ASC
`

func (q *Queries) ListAccountRoleNames(ctx context.Context, accountID string) ([]string, error) {
	rows, err := q.db.Query(ctx, listAccountRoleNames, accountID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []string
	for rows.Next() {
		var name string
		if err := rows.Scan(&name); err != nil {
			return nil, err
		}
		items = append(items, name)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}
